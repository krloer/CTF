#!/usr/bin/env python3

from pwn import *

"""
freed malloc is stored in the tcache
"""

def conn():
    # r = remote("mercury.picoctf.net", 34499)
    r = process("./heapedit")
    gdb.attach(r)

    return r


def main():
    r = conn()

    printed_address = 0x310
    address_of_flag = 0x73746172676e6f43
    bottom_of_heap = 0x602000

    # r.recvuntil("Address:")
    # r.sendline(printed_address)
    # r.recvuntil("Value:")
    # r.sendline(address_of_flag)

    r.interactive()


if __name__ == "__main__":
    main()
