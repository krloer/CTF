undefined8 main(void)

{
  long in_FS_OFFSET;
  undefined value_input;
  int address_input;
  int local_a4;
  undefined8 *local_a0;
  undefined8 *local_98;
  FILE *flag_file_desc;
  undefined8 *local_88;
  void *local_80;
  undefined8 local_78;
  undefined8 local_70;
  undefined8 local_68;
  undefined local_60;
  char flag [72];
  long stack_canary;
  
  stack_canary = *(long *)(in_FS_OFFSET + 0x28);
  setbuf(stdout,(char *)0x0);
  flag_file_desc = fopen("flag.txt","r");
  fgets(flag,0x40,flag_file_desc);
  local_78 = 0x2073692073696874;
  local_70 = 0x6d6f646e61722061;
  local_68 = 0x2e676e6972747320;
  local_60 = 0;
  local_a0 = (undefined8 *)0x0; //null pointer
  for (local_a4 = 0; local_a4 < 7; local_a4 = local_a4 + 1) { //allocates 0x80*7 bytes of memory 128*7 = 896 bytes
    local_98 = (undefined8 *)malloc(0x80); //pointer to address //bottom of heap
    if (local_a0 == (undefined8 *)0x0) { //if local_a0 == a null pointer
      local_a0 = local_98; //local a0 at bottom of heap
    }
    *local_98 = 0x73746172676e6f43;
    local_98[1] = 0x662072756f592021;
    local_98[2] = 0x203a73692067616c;
    *(undefined *)(local_98 + 3) = 0;
    strcat((char *)local_98,flag); //where is this? todo
  }
  local_88 = (undefined8 *)malloc(0x80);//allocates 0x80 bytes
  *local_88 = 0x5420217972726f53;
  local_88[1] = 0x276e6f7720736968;
  local_88[2] = 0x7920706c65682074;
  *(undefined4 *)(local_88 + 3) = 0x203a756f;
  *(undefined *)((long)local_88 + 0x1c) = 0;
  strcat((char *)local_88,(char *)&local_78);
  free(local_98); //free 0x80 bytes
  free(local_88); //free 0x80 bytes
  address_input = 0;
  value_input = 0;
  puts("You may edit one byte in the program.");
  printf("Address: ");
  __isoc99_scanf(&DAT_00400b48,&address_input);
  printf("Value: ");
  __isoc99_scanf(&DAT_00400b53,&value_input);
  *(undefined *)((long)address_input + (long)local_a0) = value_input; //pointer to input + bottom of heap = value input
  local_80 = malloc(0x80); //allocate 0x80 bytes
  puts((char *)((long)local_80 + 0x10)); //print bottom of heap + 0x310
  if (stack_canary != *(long *)(in_FS_OFFSET + 0x28)) {
                    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
  }
  return 0;